图片处理 demo
文章是 Web Fundamentals-性能-加载性能.md 的图形内容的内容扩展

1. 具备功能
   1. 图片上传
      1. client 使用 vue 和 axios，server 使用 nodejs，使用 koa2,koa-router,koa-static
      2. web 加入上传进度和图片预览
         图片预览使用 FileReader
      3. axios 进行文件上传需要注意
         1. 添加请求头。headers: { "Content-Type": "multipart/form-data" }
         2. onUploadProgress 是上传进度的关键函数
         3. 使用 formData 传递 file
   2. 图片类型过滤外加图片本地存储
      1. 后端类型校验
      2. 为了接受文件数据，并且本地保存，使用 koa-multer 中间件，它基于 multer,但是采用了 promise。
         因为 multer 的文档全面，但是 koa-multer 基本无文档，所以需要参考 multer 的文档（https://github.com/expressjs/multer/blob/master/doc/README-zh-cn.md）【git】
      3. koa-multer 的错误处理是关键，与 multer 的写法完全不同，通过 console.log 打印关键对象才分析出来的，问题关键就是是否使用了 promise，详细解释看 DEMO(test/pic 的 upload.js)
      4. 我把图片处理也做成了中间件，但是没考虑中间件传参问题，因为 demo 的重点不在这。
   3. 查看，删除图像元数据
      1. 图片上传通过koa-body
         http://www.ptbird.cn/koa-body.html【koa2 使用 koa-body 代替 koa-bodyparser 和 koa-multer】
         注意：koa-body与koa-bodyparser 和 koa-multer都不兼容，后期我改为koa-body处理
      2. exif.js负责查看图片的元数据（exif）
      3. tiny负责压缩图片，包括png和jpg
         API需要key，而且申请不支持QQ邮箱
         https://tinypng.com/【tiny在线压缩官网】accout:zhier1991
         https://tinypng.com/developers【tiny API】
         https://www.npmjs.com/package/gulp-tinypng-nokey【模拟用户上传和下载的行为，来得到压缩图片，突破使用tiny官网api每月500张限制】
         https://segmentfault.com/a/1190000015467084【nodejs 全自动使用 Tinypng （免费版，无需任何配置）压缩图片】
         https://blog.wxhbts.com/tinypng.html【tiny，这份资料或许以后用得到】
   4. 图片转 webp
   5. 图片压缩
   6. 图片预览，兼容 webp 的支持
   7. 可能的话加入图片裁剪
